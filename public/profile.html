<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông Tin Cá Nhân - D-Travel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/profile.css" rel="stylesheet">
</head>
<body>
    <div id="navbar-container"></div>

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10 col-xl-9">
                <!-- Loading Spinner -->
                <div id="loading-spinner" class="text-center py-5">
                    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Đang tải...</span>
                    </div>
                    <p class="mt-3 text-muted">Đang tải thông tin...</p>
                </div>

                <!-- Profile Card -->
                <div id="profile-card" class="profile-card d-none">
                    <!-- Avatar Section -->
                    <div class="avatar-section">
                        <div class="avatar-wrapper">
                            <img id="avatar-preview" src="" alt="Ảnh đại diện" class="avatar-img">
                            <label for="avatar-upload" class="avatar-upload-overlay" aria-label="Thay đổi ảnh đại diện">
                                <i class="fas fa-camera"></i>
                            </label>
                            <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                        </div>
                        <h2 id="user-display-name" class="user-name">Người dùng</h2>
                        <p id="user-email" class="user-email text-muted">email@example.com</p>
                    </div>

                    <!-- Profile Content -->
                    <div class="profile-content">
                        <!-- View Mode -->
                        <div id="view-mode" class="view-mode">
                            <div class="d-flex justify-content-end mb-4">
                                <button id="edit-btn" class="btn btn-primary btn-edit">
                                    <i class="fas fa-edit me-2"></i>Chỉnh sửa
                                </button>
                            </div>

                            <!-- Basic Info Section -->
                            <div class="info-section">
                                <h5 class="section-title">
                                    <i class="fas fa-user me-2"></i>Thông tin cơ bản
                                </h5>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="info-item">
                                            <label class="info-label">Họ và tên</label>
                                            <div class="info-value" id="view-ten_khach_hang">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="info-item">
                                            <label class="info-label">Ngày sinh</label>
                                            <div class="info-value" id="view-ngay_sinh">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="info-item">
                                            <label class="info-label">Giới tính</label>
                                            <div class="info-value" id="view-gioi_tinh">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="info-item">
                                            <label class="info-label">CCCD</label>
                                            <div class="info-value" id="view-cccd">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="info-item">
                                            <label class="info-label">Địa chỉ</label>
                                            <div class="info-value" id="view-dia_chi">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- System Info (Hidden by default, can be toggled) -->
                            <div class="info-section system-info">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <h6 class="section-subtitle text-muted mb-0">
                                        <i class="fas fa-info-circle me-2"></i>Thông tin hệ thống
                                    </h6>
                                    <button class="btn btn-sm btn-link text-muted p-0" id="toggle-system-info" aria-label="Ẩn/hiện thông tin hệ thống">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                                <div id="system-info-content" class="system-info-content d-none">
                                    <div class="row g-2">
                                        <div class="col-md-4">
                                            <span class="badge bg-secondary">ID: <span id="view-id-user">-</span></span>
                                        </div>
                                        <div class="col-md-4">
                                            <span class="badge bg-secondary">Mã KH: <span id="view-customer-id">-</span></span>
                                        </div>
                                        <div class="col-md-4">
                                            <span class="badge bg-secondary">Loại: <span id="view-account-type">-</span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Edit Mode -->
                        <div id="edit-mode" class="edit-mode d-none">
                            <form id="customer-form" class="needs-validation" novalidate>
                                <div class="d-flex justify-content-end mb-4">
                                    <button type="button" id="cancel-btn" class="btn btn-outline-secondary me-2">
                                        <i class="fas fa-times me-2"></i>Hủy
                                    </button>
                                    <button type="submit" class="btn btn-primary btn-save" id="save-btn">
                                        <i class="fas fa-save me-2"></i>Lưu thay đổi
                                    </button>
                                </div>

                                <!-- Basic Info Section -->
                                <div class="info-section">
                                    <h5 class="section-title">
                                        <i class="fas fa-user me-2"></i>Thông tin cơ bản
                                    </h5>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="ten_khach_hang" class="form-label">
                                                    <i class="fas fa-user me-2"></i>Họ và tên <span class="text-danger">*</span>
                                                </label>
                                                <input type="text" class="form-control" id="ten_khach_hang" name="ten_khach_hang" required>
                                                <div class="invalid-feedback">Vui lòng nhập họ và tên</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="ngay_sinh" class="form-label">
                                                    <i class="fas fa-calendar-alt me-2"></i>Ngày sinh <span class="text-danger">*</span>
                                                </label>
                                                <input type="date" class="form-control" id="ngay_sinh" name="ngay_sinh" required>
                                                <div class="invalid-feedback">Vui lòng chọn ngày sinh</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="gioi_tinh" class="form-label">
                                                    <i class="fas fa-venus-mars me-2"></i>Giới tính <span class="text-danger">*</span>
                                                </label>
                                                <select class="form-select" id="gioi_tinh" name="gioi_tinh" required>
                                                    <option value="">-- Chọn giới tính --</option>
                                                    <option value="Nam">Nam</option>
                                                    <option value="Nữ">Nữ</option>
                                                    <option value="Khác">Khác</option>
                                                </select>
                                                <div class="invalid-feedback">Vui lòng chọn giới tính</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="cccd" class="form-label">
                                                    <i class="fas fa-id-card me-2"></i>Căn cước công dân <span class="text-danger">*</span>
                                                </label>
                                                <input type="text" class="form-control" id="cccd" name="cccd" required 
                                                    pattern="[0-9]{9}|[0-9]{12}" title="CCCD phải có 9 hoặc 12 số">
                                                <div class="invalid-feedback">CCCD phải có 9 hoặc 12 số</div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="form-group">
                                                <label for="dia_chi" class="form-label">
                                                    <i class="fas fa-map-marker-alt me-2"></i>Địa chỉ <span class="text-danger">*</span>
                                                </label>
                                                <textarea class="form-control" id="dia_chi" name="dia_chi" rows="3" required></textarea>
                                                <div class="invalid-feedback">Vui lòng nhập địa chỉ</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Not Logged In -->
                <div id="not-logged-in" class="text-center p-5 d-none">
                    <div class="not-logged-card">
                        <i class="fas fa-exclamation-triangle text-warning display-4 mb-3"></i>
                        <h4>Vui lòng đăng nhập</h4>
                        <p class="text-muted mb-4">Bạn cần đăng nhập để xem và chỉnh sửa thông tin cá nhân</p>
                        <div class="d-flex gap-2 justify-content-center">
                            <a href="/auth.html" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt me-2"></i>Đăng nhập
                            </a>
                            <a href="/auth.html" class="btn btn-outline-primary">
                                <i class="fas fa-user-plus me-2"></i>Đăng ký
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="footer-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/navbar.js"></script>
    <script src="js/client/profile.js"></script>
    <script src="/js/user-block-notification.js"></script>
    <!-- Chatbox CSS -->
    <link rel="stylesheet" href="css/chatbox.css">
    <!-- Chatbox JS -->
    <script src="js/chatbox.js"></script>
</body>
</html>
